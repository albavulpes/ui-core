{"version":3,"sources":["stores/auth/IdentityStore.ts"],"names":[],"mappings":"AACA,OAAO,EAA0B,SAAS,EAAC,MAAM,kCAAkC,CAAC;AAEpF,OAAO,EAAC,WAAW,EAAC,MAAM,iCAAiC,CAAC;AAC5D,OAAO,EAAC,YAAY,EAAC,MAAM,gCAAgC,CAAC;AAE5D,qBACa,aAAc,SAAQ,SAAS;IAGxC,WAAW,EAAE,WAAW,CAAC;IAGzB,YAAY,EAAE,YAAY,CAAC;IAG3B,eAAe,EAAE,OAAO,CAAC;IAGzB,QAAQ,EAAE,MAAM,CAAC;IAGjB,KAAK,EAAE,MAAM,CAAC;IAGR,aAAa;IAcnB,OAAO,CAAC,cAAc;CAKzB","file":"IdentityStore.d.ts","sourcesContent":["import {Inject, Service} from 'typedi';\r\nimport {Action, Mutation, State, VuexStore} from '../../framework/decorators/Store';\r\n\r\nimport {AuthService} from '../../services/auth/AuthService';\r\nimport {ToastService} from '../../services/ui/ToastService';\r\n\r\n@Service()\r\nexport class IdentityStore extends VuexStore {\r\n\r\n    @Inject(() => AuthService)\r\n    AuthService: AuthService;\r\n\r\n    @Inject()\r\n    ToastService: ToastService;\r\n\r\n    @State()\r\n    IsAuthenticated: boolean;\r\n\r\n    @State()\r\n    UserName: string;\r\n\r\n    @State()\r\n    Email: string;\r\n\r\n    @Action()\r\n    async fetchIdentity() {\r\n        try {\r\n            const statusResponse = await this.AuthService.me();\r\n\r\n            this.updateIdentity(statusResponse);\r\n        }\r\n        catch (error) {\r\n            if (error.response && error.response.status !== 401) {\r\n                this.ToastService.error(error.message);\r\n            }\r\n        }\r\n    }\r\n\r\n    @Mutation()\r\n    private updateIdentity(identity: StatusResponse) {\r\n        this.UserName = identity.UserName;\r\n        this.Email = identity.Email;\r\n        this.IsAuthenticated = true;\r\n    }\r\n}\r\n"]}